mixin email(e, k)
  button.btn.btn-xs.btn-default(onclick="showEmail(this, '#{e}', '#{k}')") Показать email

doctype html
html(lang="ru")
  head
    include head
    mixin head()
  body
    #wrap
      nav.navbar.navbar-inverse.navbar-fixed-top(role="navigation")
        include nav
        mixin navheader()
        #nav-collapsible.collapse.navbar-collapse
          ul.nav.navbar-nav
            mixin navdefaultlinks("/contact")
          mixin navloginlogout("/contact")
      section#mainpage
        .container
          .col-md-8.col-md-offset-2
            h1 Контакты
            h3 Почта
            each contact in contacts
              strong= contact.name
              p.text-muted= contact.title
              mixin email(contact.email, contact.emkey)
              br
              hr
            h3 IRC
            p.
              Вы можете пообщаться с разработчиками оригинального sync/cytube на <a href="http://webchat.6irc.net/?channels=cytube">irc.6irc.net#cytube</a>.
    include footer
    mixin footer()
    script(type="text/javascript").
      function showEmail(btn, email, key) {
        email = unescape(email);
        key = unescape(key);
        var dest = new Array(email.length);
        for (var i = 0; i < email.length; i++) {
          dest[i] = String.fromCharCode(email.charCodeAt(i) ^ key.charCodeAt(i % key.length));
        }
        email = dest.join("");
        $("<a/>").attr("href", "mailto:" + email)
          .text(email)
          .insertBefore(btn);
        $(btn).remove();
      }
